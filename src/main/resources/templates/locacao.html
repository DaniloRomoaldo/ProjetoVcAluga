<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="viewport" content="width=device-width" >
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" href="/static/css/home.css">
    <link rel="stylesheet" href="/static/css/locacaoStyle.css">
    <link rel="icon" type="image/x-icon" href="/static/favicon-32x32.png"/>


    <title>Locação</title>




</head>
<body>
    
    <header>
            <!--Barra superior da página-->
        <nav>

   
                 <!-- logo hamburguer-->
            <div class="mobile-menu"> 
                <div class="line1"></div>
                <div class="line2"></div>
                <div class="line3"></div>
            </div>
                <!--Imagem do menu-->
            <div class="container-fluid">
              <img src="/static/img/vcAluga.png" class="rounded-circle">
            </div>
            <!--Lista do menu lateral-->
            <div class="list-group nav-list">
                <a href="http://localhost:8080/buscarVeiculo" class="list-group-item list-group-item-action list-group-item-secondary">Localizar Veículo</a>
                <a href="http://localhost:8080/listaManutencao" class="list-group-item list-group-item-action list-group-item-secondary">LIsta de Manutenção</a>
                <a href="http://localhost:8080/buscarCliente" class="list-group-item list-group-item-action list-group-item-secondary">Consultar Cliente</a>
                <a href="http://localhost:8080/buscarMotorista" class="list-group-item list-group-item-action list-group-item-secondary">Consultar Motorista</a>
                <a href="http://localhost:8080/cadastrarMotorista" class="list-group-item list-group-item-action list-group-item-secondary">Registrar Motorista</a>
                <a href="http://localhost:8080/cadastrarFuncionario" class="list-group-item list-group-item-action list-group-item-secondary">Registrar Funcionário</a>
                <a href="http://localhost:8080/buscarFuncionario" class="list-group-item list-group-item-action list-group-item-secondary">Pesquisar Funcionário</a>
                <a href="http://localhost:8080/cadastrarFilial" class="list-group-item list-group-item-action list-group-item-secondary">Nova Filial</a>
            </div>
        </nav>
    </header>


                <!--Nova Locação-->
                <form class="form" onsubmit="registerLocacao(event)">
                <div class="container-locacao-register">
                    <h1>Nova Locação</h1>
                    

                      <!--Container do Cliente-->
                      <div class="cliente">

                                <div class="mb-3">
                                  <label for="input-nome-cliente" class="form-label">Nome do Cliente</label>
                                  <input type="text" required class="form-control" id="input-nome-cliente" >
                                </div>

                                <div class="mb-3">
                                  <label for="input-cpfCnpj-cliente" class="form-label">CPF ou CNPJ</label>
                                  <input type="text" required pattern="[0-9]{11}|[0-9]{14}" class="form-control" id="input-cpfCnpj-cliente" >
                                </div>

                                <div class="mb-3">
                                  <label for="input-telefone-cliente" class="form-label">Telefone</label>
                                  <input type="text" required pattern="[0-9]{11}" class="form-control" id="input-telefone-cliente" >
                                </div>
                      </div>


                        <!--Container do Motorista-->
                      <div class="motorista">

                        <div class="mb-3">
                          <label for="input-nome-motorista" class="form-label">Nome do Motorista</label>
                          <input type="text" required class="form-control" id="input-nome-motorista" >
                        </div>

                        <div class="lado_lado">
                          <div class="mb-3 left-cpf">
                            <label for="input-cpf-motorista" class="form-label">CPF</label>
                            <input type="text" required pattern="[0-9]{11}" class="form-control" id="input-cpf-motorista" >
                          </div>
                          <div class="mb-3 right-cnh">
                            <label for="input-cnh-motorista" class="form-label">CNH</label>
                            <input type="text" required pattern="[0-9]{11}" class="form-control" id="input-cnh-motorista" >
                          </div>

                        </div>

                        <div class="mb-3">
                          <label for="data-nasc-motorista" class="form-label">Data de Nascimento</label>
                          <input type="date" required class="form-control" id="data-nasc-motorista" >
                        
                        </div>

                          <script>
                              $(document).ready(function() {
                                  var now = new Date();
                                  //reduzir 25 anos, idade mínima
                                  now.setFullYear(now.getFullYear() - 25);
                                  var formattedDate = now.toISOString().split('T')[0];
                                  $('#data-nasc-motorista').attr('max', formattedDate);
                              });
                          </script>

                    </div>
                    <!--      -->



                      <!-- Carousel  Imagens veículos-->
                      <div id="carouselSite" class="carousel slide">
                        <ol class="carousel-indicators">
                            <li data-target="#carouselSite" data-slide-to="0" class="active"></li>
                            <li data-target="#carouselSite" data-slide-to="1"></li>
                            <li data-target="#carouselSite" data-slide-to="2"></li>
                        </ol>
                    
                        <div class="carousel-inner">
                            <div class="carousel-item active">
                                <img src="/static/img/veiculos/hatch.png" class="img-fluid d-block w-100" alt="">
                                <div class="carousel-caption d-none d-md-block">
                                  <p>HATCH</p>
                                </div>
                            </div>
                            <div class="carousel-item">
                                <img src="/static/img/veiculos/sedan.png" class="img-fluid d-block w-100" alt="">
                                <div class="carousel-caption d-none d-md-block">
                                  <p>SEDAN</p>
                                </div>
                            </div>
                            <div class="carousel-item">
                                <img src="/static/img/veiculos/suv.png" class="img-fluid d-block w-100" alt="">
                                <div class="carousel-caption d-none d-md-block">
                                  <p>SUV</p>
                                </div>
                            </div>
                        </div>
                    
                        <a class="carousel-control-prev" href="#carouselSite" role="button" data-slide="prev">
                            <span class="carousel-control-prev-icon"></span>
                            <span class="sr-only">Anterior</span>
                        </a>
                        <a class="carousel-control-next" href="#carouselSite" role="button" data-slide="next">
                            <span class="carousel-control-next-icon"></span>
                            <span class="sr-only">Próximo</span>
                        </a>
                    </div>


                  <div class="d-grid gap-2 d-md-flex justify-content-md-end3">
                    <button type="button" class="btn btn-warning" data-element="#return-objects-ocult">Verificar Disponibilidade</button>
                  </div>
                  <script>
                          $(function() {
                          $(".btn-warning").click(function(e) {
                            e.preventDefault();
                            el = $(this).data('element');
                            $(el).toggle();
                          });
                        });

                          $(document).ready(function() {
                              // Criar uma nova data
                              var now = new Date().toISOString().split('T')[0];
                              var amanha = new Date();

                              //devolução min é amanha
                              amanha.setDate(amanha.getDate() + 1);
                              var devolucao = amanha.toISOString().split('T')[0];

                              $('#data-retirada').attr('min', now);
                              $('#data-devolucao').attr('min', devolucao);
                          });
                  </script>


                  <div class="return-objects" id="return-objects-ocult" style="display: none;">

                    <ul class="list-group" id="list-itens-veih-disponi"> <!-- aqui será inserido os veículos disponíveis -->

                    </ul>

                  </div>

                 
                    <div class="date-entre">
                      <div class="mb-3 left-retirada">
                        <label for="data-retirada" class="form-label">RETIRADA</label>
                        <input type="date" required class="form-control" id="data-retirada" >
                      </div>
                      <div class="mb-3 right-devolucao">
                        <label for="data-devolucao" class="form-label">DEVOLUÇÃO</label>
                        <input type="date" required class="form-control" id="data-devolucao" >
                      </div>

                    </div>



                    <div class="date-entre">


                              <div class="mb-3 left-valor">
                                <label class="form-label">VALOR</label>
                                <div class="card">
                                  <div class="card-body" id="valor-locacao">
                                    <!-- valor da locação aqui -->
                                  </div>
                                </div>
                              </div>
                              

                              <div class="mb-3 right-pay">
                                <fieldset class="row mb-3" id="list-tipo-pagamento">
                                  <legend class="col-form-label col-sm-2 pt-01">Forma de Pagamento</legend>
                                  <div class="col-sm-10">
                                    <div class="form-check">
                                      <input class="form-check-input" type="radio" name="grid-pagamento" id="gridRadios1" value="CREDITO" checked>
                                      <label class="form-check-label" for="gridRadios1">CREDITO</label>
                                    </div>
                                    <div class="form-check">
                                      <input class="form-check-input" type="radio" name="grid-pagamento" id="gridRadios2" value="DEBITO">
                                      <label class="form-check-label" for="gridRadios2">DEBITO</label>
                                    </div>
                              
                                    </div>
                                </fieldset>
                              </div>


                                <div class="form-check check-contract-div">
                                  <label class="form-check-label check-contract-label" for="input-contrato">
                                    Valide os dados ANTES de assinar o contrato!
                                  </label>
                                  <input class="form-check-input" type="checkbox" id="input-contrato">
                                  
                                </div>
                                
                                <div class="d-grid gap-2 d-md-flex justify-content-md-end4">
                                  <button onclick="home()" type="button"class="btn btn-danger" style=" width:150px;" href="#" >Voltar</button>
                                  <button type="submit" class="btn btn-success" id="bnt-validar" onclick="transformarBnt()">Validar Dados</button>
                                  
                                </div>
                
                                <div class="final-space">
                
                                </div>


                      </div>

                    </div>

                    <script>
                        $(document).ready(function () {
                            activeSlide = $('#carouselSite').find('.carousel-item.active .carousel-caption p').text();
                            $('#carouselSite').carousel({
                                interval: false  // desabilita a troca autmática
                            });

                            // Controle manual
                            $('.carousel-control-next').click(function () {
                                $('#carouselSite').carousel('next');
                            });

                            $('.carousel-control-prev').click(function () {
                                $('#carouselSite').carousel('prev');
                            });

                            // Capturar evento de mudança de slide
                            $('#carouselSite').on('slid.bs.carousel', function () {
                                 activeSlide = $(this).find('.carousel-item.active .carousel-caption p').text();

                                 //atualiza o valor da locação caso seja trocado o tipo
                                updateValorLocacao();
                                //console.log(activeSlide);

                            });

                            $('#data-retirada , #data-devolucao').on('change', updateValorLocacao);
                        });
                        function transformarBnt(){
                            $('#bnt-validar').css('background-color', '#28a745', 'color','#ffffff').text('Cadastrar Locação')
                        }

                        function updateValorLocacao(){
                            if ($('#data-retirada').val() && $('#data-devolucao').val()){
                                var dataRetirada = new Date($('#data-retirada').val());
                                var dataDevolucao = new Date($('#data-devolucao').val());

                                if (dataDevolucao <= dataRetirada) {
                                    alert("Devolução inválida.");
                                    $('#data-devolucao').css('border', '2px solid red')
                                    return; // Aborta a função se a validação falhar
                                }

                                //calcular a diferença de dias
                                var diffMilliSeg = Math.abs(dataDevolucao - dataRetirada);
                                var diffDias = Math.ceil(diffMilliSeg/(1000*60*60*24));

                                // multiplando o valor da locação pela quantidade em dias
                                var valorDaLocacao = valorLocacao(activeSlide, diffDias);
                                // console.log(diffDias)
                                // console.log(valorDaLocacao)

                                $('#valor-locacao').text('R$ '+ valorDaLocacao.toFixed(2));
                            }
                        }


                        function valorLocacao(veiculo, dias){
                            var precoTipoVeiculo = {
                                'HATCH': 80,
                                'SEDAN':100,
                                'SUV':120
                            }

                            var valorLocacao = precoTipoVeiculo[veiculo] || 0;
                            return valorLocacao * dias;
                        }

                        $(function (){
                            $(".btn-warning").click(function (vazio){
                                vazio.preventDefault();
                                listarVeiculosDisponiveis(activeSlide);
                            })
                        })
                    </script>
                

              </form>

    
      

      

    <script src="/static/js/home.js"></script>
    <script src="/static/js/locacao.js"></script>
</body>
</html>